{% extends "main/layout.html" %}

{% block body %}
    <div id="app"></div>
    
    {{ data|json_script:"data" }}
    <script type="text/babel">
        function App() {
            const {useState, useEffect} = React;

            const [firstName, setFirstName] = useState('');
            const [lastName, setLastName] = useState('');
            const [age, setAge] = useState();
            const [weight, setWeight] = useState();
            const [height, setHeight] = useState();

            const data = JSON.parse(document.getElementById('data').textContent);
            console.log('first_name:', firstName); 
            React.useEffect(() => {
                try {
                    setFirstName(data.first_name);
                    setLastName(data.last_name);
                    setAge(data.age);
                    setWeight(data.weight);
                    setHeight(data.height);
                } catch (error) {
                    console.error('error:', error);
                }
            }, []);

            return (
                <div>
                    <h1>{{username}}</h1>
                    <form method="post" action="{% url 'edit-profile' %}">
                        <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}" />
                        <label for="first_name">First Name: </label>
                        <input type="text" id="first_name" name="first_name" value={firstName} onChange={(e) => setFirstName(e.target.value)} />
                        <label for="last_name">Last Name: </label>
                        <input type="text" id="last_name" name="last_name" value={lastName} onChange={(e) => setLastName(e.target.value)} />
                        <label for="age">Age: </label>
                        <input type="number" id="age" name="age" value={age} onChange={(e) => setAge(e.target.value)} />
                        <label for="weight">Weight (kg):</label>
                        <input type="number" id="weight" name="weight" min="0" max="1000" step="0.01" value={weight} onChange={(e) => setWeight(e.target.value)} />
                        <label for="height">Height (meters):</label>
                        <input type="number" id="height" name="height" min="0" max="1000" step="0.01" value={height} onChange={(e) => setHeight(e.target.value)} />            
                        <input type="submit" value="Save Changes" />
                    </form>
                </div>                
            );
        }

        ReactDOM.render(<App />, document.querySelector("#app"));
    </script>


{% endblock %}